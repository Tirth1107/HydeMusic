[{"filePath":"D:\\PROJECTS\\HYDE-MUSIC\\DESKTOP(FLASK + REACT)\\VibeEra\\Frontend\\Chatbot-Main\\src\\Components\\Music.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[70,77],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'isLoading' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":42,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":42,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"isLoading"},"fix":{"range":[3140,3149],"text":""},"desc":"Remove unused variable 'isLoading'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'initializePlayer'. Either include it or remove the dependency array.","line":118,"column":6,"nodeType":"ArrayExpression","endLine":118,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [currentTrack, initializePlayer, playerReady]","fix":{"range":[5903,5930],"text":"[currentTrack, initializePlayer, playerReady]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":137,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":137,"endColumn":23},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":137,"column":25,"nodeType":"BlockStatement","messageId":"unexpected","endLine":137,"endColumn":28,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[6779,6780],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":190,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":190,"endColumn":19},{"ruleId":"no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":207,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":207,"endColumn":15},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'selectedPlaylist.id', 'selectedPlaylist.search', 'selectedPlaylist?.type', and 'systemTracks'. Either include them or remove the dependency array.","line":402,"column":6,"nodeType":"ArrayExpression","endLine":402,"endColumn":26,"suggestions":[{"desc":"Update the dependencies array to be: [selectedPlaylist.id, selectedPlaylist.search, selectedPlaylist?.type, selectedPlaylistId, systemTracks]","fix":{"range":[15528,15548],"text":"[selectedPlaylist.id, selectedPlaylist.search, selectedPlaylist?.type, selectedPlaylistId, systemTracks]"}}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useRef, useEffect } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport {\r\n  X, Search, Play, Pause, SkipBack, SkipForward, Music,\r\n  Shuffle, List, Plus, Volume2, VolumeX, Check, Sparkles,\r\n  Home, Library, MoreVertical, Trash2, Heart\r\n} from \"lucide-react\";\r\nimport AuthButton from \"./AuthButton\";\r\n\r\nconst CURATED_PLAYLISTS = [\r\n  { id: 'c1', name: 'Hindi Party Hits', color: '#ff4b2b', description: 'Non-stop Bollywood party anthems.', search: 'hindi party songs' },\r\n  { id: 'c2', name: 'Lo-Fi Study', color: '#8e2de2', description: 'Beats to keep you focused.', search: 'lofi hip hop' },\r\n  { id: 'c3', name: 'Global Top 50', color: '#1e90ff', description: 'The biggest hits across the globe.', search: 'top global hits' },\r\n  { id: 'c4', name: 'Zen Garden', color: '#00b09b', description: 'Deep meditation and peaceful vibes.', search: 'meditation music' },\r\n  { id: 'c5', name: '90s Bollywood', color: '#f9d423', description: 'The golden era of melodies.', search: '90s hindi hits' },\r\n  { id: 'c6', name: 'Rock Legends', color: '#434343', description: 'Classic rock that never dies.', search: 'classic rock legends' },\r\n  { id: 'c7', name: 'EDM Pulse', color: '#0575e6', description: 'High-energy dance floor killers.', search: 'edm festival hits' },\r\n  { id: 'c8', name: 'Romantic Mood', color: '#e14eca', description: 'Soulful tracks for your special ones.', search: 'romantic hindi songs' },\r\n  { id: 'c9', name: 'Workout Power', color: '#ff5f6d', description: 'Push your limits with heavy beats.', search: 'workout motivation songs' },\r\n  { id: 'c10', name: 'Jazz Cafe', color: '#134e5e', description: 'Smooth jazz for a classy evening.', search: 'smooth jazz classics' },\r\n  { id: 'c11', name: 'Indie Vibes', color: '#4facfe', description: 'Discover the best independent artists.', search: 'indie pop' },\r\n  { id: 'c12', name: 'Classical Bliss', color: '#667eea', description: 'The timeless beauty of orchestra.', search: 'classical piano' },\r\n  { id: 'c13', name: 'Hip Hop Real', color: '#000000', description: 'Pure street energy and flow.', search: 'hip hop essentials' },\r\n  { id: 'c14', name: 'Acoustic Soul', color: '#f6d365', description: 'Raw emotions through strings.', search: 'acoustic pop' },\r\n  { id: 'c15', name: 'Trending India', color: '#ff0844', description: 'What India is listening to right now.', search: 'top hindu songs india' },\r\n];\r\n\r\nexport default function MusicPage() {\r\n  const [activeView, setActiveView] = useState(\"home\"); // home, search, playlist\r\n  const [selectedPlaylistId, setSelectedPlaylistId] = useState(null);\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [suggestions, setSuggestions] = useState([]);\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [currentTrack, setCurrentTrack] = useState(() => {\r\n    try {\r\n      const saved = localStorage.getItem('player.currentTrack');\r\n      return saved ? JSON.parse(saved) : null;\r\n    } catch { return null; }\r\n  });\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [searchLoading, setSearchLoading] = useState(false);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [duration, setDuration] = useState(0);\r\n\r\n  // Custom Playlists State\r\n  const [playlists, setPlaylists] = useState(() => {\r\n    try {\r\n      const saved = localStorage.getItem('player.customPlaylists');\r\n      return saved ? JSON.parse(saved) : [\r\n        { id: 'liked', name: 'Liked Songs', tracks: [], type: 'system' }\r\n      ];\r\n    } catch {\r\n      return [{ id: 'liked', name: 'Liked Songs', tracks: [], type: 'system' }];\r\n    }\r\n  });\r\n\r\n  // Recently Played State\r\n  const [recentlyPlayed, setRecentlyPlayed] = useState(() => {\r\n    try {\r\n      const saved = localStorage.getItem('player.recentlyPlayed');\r\n      return saved ? JSON.parse(saved) : [];\r\n    } catch { return []; }\r\n  });\r\n\r\n  const [playlist, setPlaylist] = useState(() => {\r\n    try {\r\n      const saved = localStorage.getItem('player.playlist');\r\n      return saved ? JSON.parse(saved) : [];\r\n    } catch { return []; }\r\n  });\r\n  const [currentIndex, setCurrentIndex] = useState(() => {\r\n    const saved = localStorage.getItem('player.currentIndex');\r\n    return saved ? parseInt(saved, 10) : 0;\r\n  });\r\n  const [isShuffled, setIsShuffled] = useState(() => {\r\n    const saved = localStorage.getItem('player.isShuffled');\r\n    return saved ? JSON.parse(saved) : false;\r\n  });\r\n  const [volume, setVolume] = useState(0.7);\r\n  const [isMuted, setIsMuted] = useState(false);\r\n  const [playerReady, setPlayerReady] = useState(false);\r\n  const [toast, setToast] = useState({ show: false, message: \"\", type: \"success\" });\r\n\r\n  const playerRef = useRef(null);\r\n  const suggestionsRef = useRef(null);\r\n  const mainContentRef = useRef(null);\r\n\r\n  const showToast = (message, type = \"success\") => {\r\n    setToast({ show: true, message, type });\r\n    setTimeout(() => {\r\n      setToast({ show: false, message: \"\", type: \"success\" });\r\n    }, 3000);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const initYouTubeAPI = () => {\r\n      if (window.YT && window.YT.Player) {\r\n        setPlayerReady(true);\r\n      } else {\r\n        if (!window.YT && !document.querySelector('script[src*=\"youtube.com/iframe_api\"]')) {\r\n          const tag = document.createElement('script');\r\n          tag.src = 'https://www.youtube.com/iframe_api';\r\n          const firstScriptTag = document.getElementsByTagName('script')[0];\r\n          firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n        }\r\n        window.onYouTubeIframeAPIReady = () => setPlayerReady(true);\r\n      }\r\n    };\r\n    initYouTubeAPI();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (currentTrack && playerReady && currentTrack.youtube_id) {\r\n      initializePlayer();\r\n    }\r\n  }, [currentTrack, playerReady]);\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem('player.currentTrack', JSON.stringify(currentTrack));\r\n    localStorage.setItem('player.currentIndex', String(currentIndex));\r\n    localStorage.setItem('player.playlist', JSON.stringify(playlist));\r\n    localStorage.setItem('player.isShuffled', JSON.stringify(isShuffled));\r\n    localStorage.setItem('player.customPlaylists', JSON.stringify(playlists));\r\n    localStorage.setItem('player.recentlyPlayed', JSON.stringify(recentlyPlayed));\r\n  }, [currentTrack, currentIndex, playlist, isShuffled, playlists, recentlyPlayed]);\r\n\r\n  useEffect(() => {\r\n    let interval;\r\n    if (isPlaying) {\r\n      interval = setInterval(() => {\r\n        try {\r\n          if (playerRef.current?.getCurrentTime) {\r\n            setCurrentTime(playerRef.current.getCurrentTime());\r\n          }\r\n        } catch (error) { }\r\n      }, 500);\r\n    }\r\n    return () => clearInterval(interval);\r\n  }, [isPlaying]);\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (suggestionsRef.current && !suggestionsRef.current.contains(event.target)) {\r\n        setShowSuggestions(false);\r\n      }\r\n    };\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const fetchSuggestions = async () => {\r\n      if (searchQuery.trim().length < 2) {\r\n        setSuggestions([]);\r\n        return;\r\n      }\r\n      try {\r\n        const response = await fetch(`http://127.0.0.1:5001/suggestions?q=${encodeURIComponent(searchQuery)}`);\r\n        const data = await response.json();\r\n        setSuggestions(data);\r\n      } catch (error) {\r\n        console.error(\"Suggestions error:\", error);\r\n      }\r\n    };\r\n    const timer = setTimeout(fetchSuggestions, 300);\r\n    return () => clearTimeout(timer);\r\n  }, [searchQuery]);\r\n\r\n  useEffect(() => {\r\n    if (mainContentRef.current) {\r\n      mainContentRef.current.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  }, [activeView, selectedPlaylistId]);\r\n\r\n  const searchMusic = async (query) => {\r\n    if (!query.trim()) return;\r\n    setSearchLoading(true);\r\n    setShowSuggestions(false);\r\n    setActiveView(\"search\");\r\n    try {\r\n      const response = await fetch('http://127.0.0.1:5001/search_music', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ query }),\r\n      });\r\n      const data = await response.json();\r\n      setSearchResults(data.tracks || []);\r\n    } catch (error) {\r\n      showToast(\"Search failed\", \"error\");\r\n    } finally {\r\n      setSearchLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadPlaylistTracks = async (query) => {\r\n    setSearchLoading(true);\r\n    try {\r\n      const response = await fetch('http://127.0.0.1:5001/search_music', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ query }),\r\n      });\r\n      const data = await response.json();\r\n      return data.tracks || [];\r\n    } catch (e) {\r\n      return [];\r\n    } finally {\r\n      setSearchLoading(false);\r\n    }\r\n  };\r\n\r\n  const handlePlaylistClick = async (pl) => {\r\n    setSelectedPlaylistId(pl.id);\r\n    setActiveView('playlist');\r\n  };\r\n\r\n  const initializePlayer = () => {\r\n    let container = document.getElementById('youtube-player');\r\n    if (!container) {\r\n      container = document.createElement('div');\r\n      container.id = 'youtube-player';\r\n      container.style.cssText = 'position: fixed; top: -9999px; left: -9999px; opacity: 0;';\r\n      document.body.appendChild(container);\r\n    }\r\n    if (playerRef.current) playerRef.current.destroy();\r\n\r\n    playerRef.current = new window.YT.Player(container, {\r\n      videoId: currentTrack.youtube_id,\r\n      playerVars: { autoplay: 1, controls: 0, modestbranding: 1, rel: 0 },\r\n      events: {\r\n        onReady: (e) => {\r\n          setDuration(e.target.getDuration());\r\n          e.target.setVolume(volume * 100);\r\n          setIsLoading(false);\r\n          e.target.playVideo();\r\n        },\r\n        onStateChange: (e) => {\r\n          if (e.data === window.YT.PlayerState.PLAYING) setIsPlaying(true);\r\n          else if (e.data === window.YT.PlayerState.PAUSED) setIsPlaying(false);\r\n          else if (e.data === window.YT.PlayerState.ENDED) {\r\n            setIsPlaying(false);\r\n            handleNext();\r\n          }\r\n        },\r\n        onError: (e) => {\r\n          console.error(\"YT Player Error:\", e.data);\r\n          handleNext(); // Skip if error\r\n        }\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleNext = () => {\r\n    if (playlist.length === 0) return;\r\n    let nextIdx = isShuffled\r\n      ? Math.floor(Math.random() * playlist.length)\r\n      : (currentIndex + 1) % playlist.length;\r\n    setCurrentIndex(nextIdx);\r\n    setCurrentTrack(playlist[nextIdx]);\r\n  };\r\n\r\n  const handlePrevious = () => {\r\n    if (playlist.length === 0) return;\r\n    let prevIdx = (currentIndex - 1 + playlist.length) % playlist.length;\r\n    setCurrentIndex(prevIdx);\r\n    setCurrentTrack(playlist[prevIdx]);\r\n  };\r\n\r\n  const togglePlayPause = () => {\r\n    if (!playerRef.current) return;\r\n    isPlaying ? playerRef.current.pauseVideo() : playerRef.current.playVideo();\r\n  };\r\n\r\n  const handleProgressChange = (e) => {\r\n    const time = parseFloat(e.target.value);\r\n    setCurrentTime(time);\r\n    playerRef.current?.seekTo(time);\r\n  };\r\n\r\n  const formatTime = (s) => `${Math.floor(s / 60)}:${Math.floor(s % 60).toString().padStart(2, '0')}`;\r\n\r\n  const createPlaylist = () => {\r\n    const newPlaylist = {\r\n      id: Date.now().toString(),\r\n      name: `My Playlist #${playlists.length}`,\r\n      tracks: [],\r\n      type: 'custom'\r\n    };\r\n    setPlaylists([...playlists, newPlaylist]);\r\n    showToast(\"Playlist created\");\r\n  };\r\n\r\n  const addTrackToPlaylist = (playlistId, track) => {\r\n    setPlaylists(playlists.map(pl => {\r\n      if (pl.id === playlistId) {\r\n        if (pl.tracks.find(t => t.id === track.id)) {\r\n          showToast(\"Already in playlist\", \"info\");\r\n          return pl;\r\n        }\r\n        showToast(`Added to ${pl.name}`);\r\n        return { ...pl, tracks: [...pl.tracks, track] };\r\n      }\r\n      return pl;\r\n    }));\r\n  };\r\n\r\n  const removePlaylist = (id) => {\r\n    if (id === 'liked') return;\r\n    setPlaylists(playlists.filter(pl => pl.id !== id));\r\n    if (selectedPlaylistId === id) setActiveView('home');\r\n    showToast(\"Playlist removed\");\r\n  };\r\n\r\n  const playTrack = (track, newQueue = null) => {\r\n    // Add to History\r\n    setRecentlyPlayed(prev => {\r\n      const filtered = prev.filter(t => t.id !== track.id);\r\n      return [track, ...filtered].slice(0, 20);\r\n    });\r\n\r\n    if (newQueue) {\r\n      setPlaylist(newQueue);\r\n      const idx = newQueue.findIndex(t => t.id === track.id);\r\n      setCurrentIndex(idx >= 0 ? idx : 0);\r\n    } else {\r\n      if (!playlist.find(t => t.id === track.id)) {\r\n        setPlaylist([track, ...playlist]);\r\n        setCurrentIndex(0);\r\n      } else {\r\n        const idx = playlist.findIndex(t => t.id === track.id);\r\n        setCurrentIndex(idx);\r\n      }\r\n    }\r\n    setCurrentTrack(track);\r\n  };\r\n\r\n  const renderTrackItem = (track, index, queueContext = null) => (\r\n    <motion.div\r\n      key={`${track.id}-${index}`}\r\n      layout\r\n      initial={{ opacity: 0, x: -10 }}\r\n      animate={{ opacity: 1, x: 0 }}\r\n      className={`track-item ${currentTrack?.id === track.id ? 'active' : ''}`}\r\n      onClick={() => playTrack(track, queueContext)}\r\n    >\r\n      <div className=\"track-index\">\r\n        {currentTrack?.id === track.id && isPlaying ? (\r\n          <div className=\"music-bars mini\">\r\n            <span></span><span></span><span></span>\r\n          </div>\r\n        ) : index + 1}\r\n      </div>\r\n      <div style={{ display: 'flex', alignItems: 'center', gap: '12px', minWidth: 0 }}>\r\n        <img src={track.image} alt=\"\" className=\"track-image\" />\r\n        <div className=\"track-main-info\">\r\n          <div className=\"track-name\">{track.name}</div>\r\n          <div className=\"track-artist\">{track.artists?.join(', ')}</div>\r\n        </div>\r\n      </div>\r\n      <div className=\"track-album\">Single / Hyde Music</div>\r\n      <div style={{ display: 'flex', gap: '16px', alignItems: 'center', justifyContent: 'flex-end' }}>\r\n        <Plus\r\n          size={18}\r\n          className=\"hover:text-white\"\r\n          onClick={(e) => {\r\n            e.stopPropagation();\r\n            addTrackToPlaylist('liked', track);\r\n          }}\r\n        />\r\n        <Heart\r\n          size={18}\r\n          className={playlists.find(p => p.id === 'liked')?.tracks.some(t => t.id === track.id) ? 'text-red-500 fill-red-500' : ''}\r\n          onClick={(e) => {\r\n            e.stopPropagation();\r\n            addTrackToPlaylist('liked', track);\r\n          }}\r\n        />\r\n      </div>\r\n    </motion.div>\r\n  );\r\n\r\n  const getActivePlaylist = () => {\r\n    const custom = playlists.find(p => p.id === selectedPlaylistId);\r\n    if (custom) return custom;\r\n    const curated = CURATED_PLAYLISTS.find(p => p.id === selectedPlaylistId);\r\n    if (curated) return { ...curated, type: 'system' };\r\n    return null;\r\n  };\r\n\r\n  const selectedPlaylist = getActivePlaylist();\r\n\r\n  // Load tracks for system playlists on demand\r\n  const [systemTracks, setSystemTracks] = useState({});\r\n  useEffect(() => {\r\n    if (selectedPlaylist?.type === 'system' && selectedPlaylist.id !== 'liked' && !systemTracks[selectedPlaylist.id]) {\r\n      loadPlaylistTracks(selectedPlaylist.search).then(tracks => {\r\n        setSystemTracks(prev => ({ ...prev, [selectedPlaylist.id]: tracks }));\r\n      });\r\n    }\r\n  }, [selectedPlaylistId]);\r\n\r\n  const activeTracks = selectedPlaylist?.id === 'liked' ? selectedPlaylist.tracks :\r\n    (selectedPlaylist?.type === 'system' ? systemTracks[selectedPlaylist.id] || [] : selectedPlaylist?.tracks || []);\r\n\r\n  return (\r\n    <div className=\"hyde-music-container animate-fade\">\r\n      <nav className=\"hyde-sidebar\">\r\n        <div className=\"sidebar-nav\">\r\n          <div className=\"brand\" onClick={() => setActiveView('home')} style={{ cursor: 'pointer' }}>\r\n            <Music size={28} className=\"color-primary\" />\r\n            <h1>Hyde Music</h1>\r\n          </div>\r\n          <div className={`nav-item ${activeView === 'home' ? 'active' : ''}`} onClick={() => setActiveView('home')}>\r\n            <Home size={24} /> <span>Home</span>\r\n          </div>\r\n          <div className={`nav-item ${activeView === 'search' ? 'active' : ''}`} onClick={() => setActiveView('search')}>\r\n            <Search size={24} /> <span>Search</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"sidebar-library\">\r\n          <div className=\"library-header\">\r\n            <h3><Library size={24} /> <span>Your Library</span></h3>\r\n            <Plus size={20} className=\"plus-btn\" onClick={createPlaylist} />\r\n          </div>\r\n          <div className=\"sidebar-playlists\">\r\n            {playlists.map(pl => (\r\n              <div\r\n                key={pl.id}\r\n                className={`playlist-item ${selectedPlaylistId === pl.id && activeView === 'playlist' ? 'active-bg' : ''}`}\r\n                onClick={() => {\r\n                  setSelectedPlaylistId(pl.id);\r\n                  setActiveView('playlist');\r\n                }}\r\n              >\r\n                <div className=\"playlist-art\">\r\n                  {pl.id === 'liked' ? <Heart className=\"text-red-500 fill-red-500\" /> : <List size={24} />}\r\n                </div>\r\n                <div className=\"playlist-info\">\r\n                  <div className=\"playlist-name\">{pl.name}</div>\r\n                  <div className=\"playlist-meta\">Playlist • {pl.tracks.length} songs</div>\r\n                </div>\r\n                {pl.type !== 'system' && (\r\n                  <Trash2 size={16} className=\"text-dim hover:text-red-500\" onClick={(e) => { e.stopPropagation(); removePlaylist(pl.id); }} />\r\n                )}\r\n              </div>\r\n            ))}\r\n            <div className=\"sidebar-divider\"></div>\r\n            {CURATED_PLAYLISTS.map(pl => (\r\n              <div\r\n                key={pl.id}\r\n                className={`playlist-item ${selectedPlaylistId === pl.id && activeView === 'playlist' ? 'active-bg' : ''}`}\r\n                onClick={() => handlePlaylistClick(pl)}\r\n              >\r\n                <div className=\"playlist-art\" style={{ background: `linear-gradient(135deg, ${pl.color}, #000)` }}>\r\n                  <Music size={18} color=\"white\" />\r\n                </div>\r\n                <div className=\"playlist-info\">\r\n                  <div className=\"playlist-name\">{pl.name}</div>\r\n                  <div className=\"playlist-meta\">Curated Playlist</div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </nav>\r\n\r\n      <main className=\"hyde-main-content\" ref={mainContentRef}>\r\n        <header className=\"main-header\">\r\n          <div className=\"search-container\" ref={suggestionsRef}>\r\n            <Search size={20} className=\"search-icon\" />\r\n            <input\r\n              className=\"search-input\"\r\n              value={searchQuery}\r\n              onChange={(e) => { setSearchQuery(e.target.value); setShowSuggestions(true); }}\r\n              onFocus={() => { setShowSuggestions(true); setActiveView('search'); }}\r\n              onKeyDown={(e) => e.key === 'Enter' && searchMusic(searchQuery)}\r\n              placeholder=\"What do you want to listen to?\"\r\n            />\r\n            <AnimatePresence>\r\n              {showSuggestions && suggestions.length > 0 && (\r\n                <motion.div initial={{ opacity: 0, y: -10 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -10 }} className=\"suggestions-box\">\r\n                  {suggestions.map((s, i) => (\r\n                    <div key={i} className=\"suggestion-item\" onClick={() => { setSearchQuery(s); searchMusic(s); }}>\r\n                      <Search size={14} /> {s}\r\n                    </div>\r\n                  ))}\r\n                </motion.div>\r\n              )}\r\n            </AnimatePresence>\r\n          </div>\r\n          <AuthButton />\r\n        </header>\r\n\r\n        <section className=\"main-section\">\r\n          <AnimatePresence mode=\"wait\">\r\n            {activeView === 'home' && (\r\n              <motion.div\r\n                key=\"home\"\r\n                initial={{ opacity: 0, scale: 0.98 }}\r\n                animate={{ opacity: 1, scale: 1 }}\r\n                exit={{ opacity: 0, scale: 0.98 }}\r\n                transition={{ duration: 0.2 }}\r\n              >\r\n                <h2 className=\"section-title\">Good Evening</h2>\r\n                <div className=\"shelf-grid-simple\">\r\n                  {playlists.concat(CURATED_PLAYLISTS.slice(0, 3)).slice(0, 6).map(pl => (\r\n                    <div key={pl.id} className=\"simple-card glassy\" onClick={() => handlePlaylistClick(pl)}>\r\n                      <div className=\"simple-card-art\" style={pl.color ? { background: `linear-gradient(135deg, ${pl.color}, #000)` } : {}}>\r\n                        {pl.id === 'liked' ? <Heart size={20} className=\"text-red-500 fill-red-500\" /> : <Music size={20} color=\"white\" />}\r\n                      </div>\r\n                      <span>{pl.name}</span>\r\n                      <button className=\"simple-play-btn\"><Play fill=\"black\" size={16} /></button>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n\r\n                {recentlyPlayed.length > 0 && (\r\n                  <div className=\"shelf-section\">\r\n                    <h3 className=\"shelf-title\">Recently Played</h3>\r\n                    <div className=\"shelf-grid\">\r\n                      {recentlyPlayed.slice(0, 6).map((track) => (\r\n                        <div key={track.id} className=\"shelf-card\" onClick={() => playTrack(track, recentlyPlayed)}>\r\n                          <img src={track.image} alt=\"\" className=\"shelf-img\" />\r\n                          <div className=\"shelf-info\">\r\n                            <div className=\"shelf-name\">{track.name}</div>\r\n                            <div className=\"shelf-artist\">{track.artists?.[0]}</div>\r\n                          </div>\r\n                          <button className=\"shelf-play-btn\"><Play fill=\"black\" size={20} /></button>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                <div className=\"shelf-section\">\r\n                  <h3 className=\"shelf-title\">Curated For You</h3>\r\n                  <div className=\"shelf-grid\">\r\n                    {CURATED_PLAYLISTS.slice(0, 6).map((pl) => (\r\n                      <div key={pl.id} className=\"shelf-card\" onClick={() => handlePlaylistClick(pl)}>\r\n                        <div className=\"shelf-img-mock\" style={{ background: `linear-gradient(135deg, ${pl.color}, #000)` }}>\r\n                          <Music size={48} color=\"white\" opacity={0.3} />\r\n                        </div>\r\n                        <div className=\"shelf-info\">\r\n                          <div className=\"shelf-name\">{pl.name}</div>\r\n                          <div className=\"shelf-artist\">{pl.description}</div>\r\n                        </div>\r\n                        <button className=\"shelf-play-btn\"><Play fill=\"black\" size={20} /></button>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"shelf-section\">\r\n                  <h3 className=\"shelf-title\">Moods & Energy</h3>\r\n                  <div className=\"shelf-grid\">\r\n                    {CURATED_PLAYLISTS.slice(6, 12).map((pl) => (\r\n                      <div key={pl.id} className=\"shelf-card\" onClick={() => handlePlaylistClick(pl)}>\r\n                        <div className=\"shelf-img-mock\" style={{ background: `linear-gradient(135deg, ${pl.color}, #000)` }}>\r\n                          <Sparkles size={48} color=\"white\" opacity={0.3} />\r\n                        </div>\r\n                        <div className=\"shelf-info\">\r\n                          <div className=\"shelf-name\">{pl.name}</div>\r\n                          <div className=\"shelf-artist\">{pl.description}</div>\r\n                        </div>\r\n                        <button className=\"shelf-play-btn\"><Play fill=\"black\" size={20} /></button>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n\r\n            {activeView === 'search' && (\r\n              <motion.div\r\n                key=\"search\"\r\n                initial={{ opacity: 0, x: 20 }}\r\n                animate={{ opacity: 1, x: 0 }}\r\n                exit={{ opacity: 0, x: -20 }}\r\n                transition={{ duration: 0.2 }}\r\n              >\r\n                <h2 className=\"section-title\">{searchQuery ? `Results for \"${searchQuery}\"` : 'Browse All'}</h2>\r\n                {!searchQuery && (\r\n                  <div className=\"genre-grid\">\r\n                    {CURATED_PLAYLISTS.map(pl => (\r\n                      <div key={pl.id} className=\"genre-card\" style={{ background: pl.color }} onClick={() => handlePlaylistClick(pl)}>\r\n                        <span>{pl.name}</span>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n                <div className=\"track-list\">\r\n                  {searchResults.map((track, i) => renderTrackItem(track, i, searchResults))}\r\n                  {searchLoading && <div style={{ textAlign: 'center', padding: '20px' }}><Sparkles className=\"animate-spin\" /></div>}\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n\r\n            {activeView === 'playlist' && selectedPlaylist && (\r\n              <motion.div\r\n                key={`playlist-${selectedPlaylistId}`}\r\n                initial={{ opacity: 0, y: 20 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                exit={{ opacity: 0, y: -20 }}\r\n                transition={{ duration: 0.2 }}\r\n              >\r\n                <div className=\"playlist-header-detail\" style={{ background: `linear-gradient(to bottom, ${selectedPlaylist.color || '#ff0000'}44 0%, transparent 100%)` }}>\r\n                  <div className=\"playlist-art-large\" style={selectedPlaylist.color ? { background: `linear-gradient(135deg, ${selectedPlaylist.color}, #000)` } : {}}>\r\n                    {selectedPlaylist.id === 'liked' ? <Heart size={80} className=\"text-red-500 fill-red-500\" /> : <Music size={80} color=\"white\" />}\r\n                  </div>\r\n                  <div className=\"playlist-info-large\">\r\n                    <div className=\"playlist-label\">{selectedPlaylist.type === 'system' ? 'System Curation' : 'Playlist'}</div>\r\n                    <h1 className=\"playlist-name-large\">{selectedPlaylist.name}</h1>\r\n                    <div className=\"playlist-stats\">\r\n                      <span className=\"owner\">Hyde Music</span> • {activeTracks.length} songs\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"track-list\" style={{ marginTop: '24px' }}>\r\n                  {searchLoading && <div style={{ textAlign: 'center', padding: '40px' }}><Sparkles className=\"animate-spin\" /> Fetching curated beats...</div>}\r\n                  {activeTracks.map((track, i) => renderTrackItem(track, i, activeTracks))}\r\n                  {!searchLoading && activeTracks.length === 0 && (\r\n                    <div style={{ color: 'var(--color-text-secondary)', textAlign: 'center', padding: '60px 0' }}>\r\n                      <p>No tracks found for this curation.</p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </motion.div>\r\n            )}\r\n          </AnimatePresence>\r\n        </section>\r\n      </main>\r\n\r\n      <footer className=\"hyde-player-bar\">\r\n        <div className=\"player-left\">\r\n          {currentTrack && (\r\n            <>\r\n              <motion.img\r\n                key={currentTrack.id}\r\n                initial={{ opacity: 0, scale: 0.8 }}\r\n                animate={{ opacity: 1, scale: 1 }}\r\n                src={currentTrack.image}\r\n                className=\"player-track-image\"\r\n                alt=\"\"\r\n              />\r\n              <div className=\"player-track-info\">\r\n                <div className=\"player-track-name\">{currentTrack.name}</div>\r\n                <div className=\"player-track-artist\">{currentTrack.artists?.[0]}</div>\r\n              </div>\r\n              <Heart\r\n                size={18}\r\n                className={`ml-4 cursor-pointer transition-colors ${playlists.find(p => p.id === 'liked')?.tracks.some(t => t.id === currentTrack.id) ? 'text-red-500 fill-red-500' : 'hover:text-white'}`}\r\n                onClick={() => addTrackToPlaylist('liked', currentTrack)}\r\n              />\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"player-center\">\r\n          <div className=\"player-controls\">\r\n            <Shuffle\r\n              size={18}\r\n              className={isShuffled ? 'color-primary' : 'hover:text-white'}\r\n              onClick={() => setIsShuffled(!isShuffled)}\r\n            />\r\n            <SkipBack size={20} className=\"hover:text-white\" onClick={handlePrevious} />\r\n            <button className=\"play-button\" onClick={togglePlayPause}>\r\n              {isPlaying ? <Pause size={20} fill=\"#000\" /> : <Play size={20} fill=\"#000\" style={{ marginLeft: '2px' }} />}\r\n            </button>\r\n            <SkipForward size={20} className=\"hover:text-white\" onClick={handleNext} />\r\n          </div>\r\n          <div className=\"progress-bar-container\">\r\n            <span>{formatTime(currentTime)}</span>\r\n            <input\r\n              type=\"range\"\r\n              className=\"progress-slider\"\r\n              min=\"0\" max={duration}\r\n              value={currentTime}\r\n              onChange={handleProgressChange}\r\n            />\r\n            <span>{formatTime(duration)}</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"player-right\">\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '16px', justifyContent: 'flex-end', color: 'var(--color-text-secondary)' }}>\r\n            <Sparkles size={18} className=\"cursor-pointer hover:text-white\" onClick={() => showToast(\"AI Recommendation coming soon!\")} />\r\n            <List size={18} className=\"cursor-pointer hover:text-white\" onClick={() => showToast(\"Next in queue...\")} />\r\n            <div className=\"volume-control-wrapper\">\r\n              {isMuted || volume === 0 ? <VolumeX size={18} className=\"hover:text-white\" onClick={() => { setIsMuted(false); playerRef.current?.setVolume(volume * 100); }} /> :\r\n                volume < 0.3 ? <Volume2 size={18} className=\"hover:text-white\" /> :\r\n                  volume < 0.7 ? <Volume2 size={18} className=\"hover:text-white\" /> :\r\n                    <Volume2 size={18} className=\"hover:text-white\" />}\r\n              <input\r\n                type=\"range\"\r\n                className=\"progress-slider mini\"\r\n                min=\"0\" max=\"1\" step=\"0.01\"\r\n                value={isMuted ? 0 : volume}\r\n                onChange={(e) => {\r\n                  const v = parseFloat(e.target.value);\r\n                  setVolume(v);\r\n                  playerRef.current?.setVolume(v * 100);\r\n                  if (v > 0) setIsMuted(false);\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </footer>\r\n\r\n      <AnimatePresence>\r\n        {toast.show && (\r\n          <motion.div initial={{ opacity: 0, scale: 0.9, y: 20 }} animate={{ opacity: 1, scale: 1, y: 0 }} exit={{ opacity: 0, scale: 0.9, y: 20 }} className=\"toast\">\r\n            {toast.type === 'success' ? <Check size={16} /> : <X size={16} />}\r\n            {toast.message}\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]}]